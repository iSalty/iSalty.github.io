<!DOCTYPE html>
<html>
<head>
	<title>Ian's EE Blog</title>
  	<meta charset="utf-8" />
  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  	<link href='https://fonts.googleapis.com/css?family=Roboto|Ubuntu' rel='stylesheet' type='text/css'>
  	<link rel="stylesheet" type="text/css" href="main.css">
</head>

<body>
	<div class="page-header">
		<h1>Ian's EE Blog</h1>
		<h4>Keeping up to date with all of the zany things I do.</h4>
	</div>
	<nav class="container">
		<div class="row">
			<div class="col-md-1 col-sm-2">
				<a href="https://www.linkedin.com/in/ian-saltwick-23591b81"><img class="nav-bar-logo" src="logos/linkedin_logo.png"/>LinkedIn</a>
			</div>
			<div class="col-md-1 col-sm-2">
				<a href="https://www.facebook.com/ian.saltwick"><img class="nav-bar-logo" src="logos/facebook_logo.png"/>Facebook</a>
			</div>
			<div class="col-md-1 col-sm-2">
				<a href="https://github.com/iSalty"><img class="nav-bar-logo" src="logos/github_logo.png"/>GitHub</a>
			</div>
		</div>
	</nav>
	<section class="container">
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">August 20, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">About This Site</h3>
				<p class="post-text"> 
					Hi, I am a recent graduate from Arizona State University in the field of Electrical Engineering. I have been involved in a few noteworthy projects during my time in college and would love to continue tinkering and inventing on my own time. I intend for this to be the site where others can come to see what projects I have been working on and my thought process throughout the time that I was involved in those projects. 
				</p>
				<p class="post-text">
					I am putting together this website to serve as a platform to share the many fun and interesting projects I am working on and to serve as some sort of a portfolio of my projects. Building this website was a project in itself. Never before have I had any experience with web design and I wanted to learn how to make a website essentially only using the barebones HTML and CSS code. So I headed over to <a href="https://www.codecademy.com/learn" target="_blank"> codecademy.com</a> and spent a day learning HTML, CSS and the bootstrap framework in the Making a Website course. I spent another day scouring the internet to find inspiration on the asthetic of the website. Finally, I spent one day sitting down and coding the thing. It surprised me just how quickly I picked it up and I really ended up enjoying it. Having complete control over the layout (down to the pixel) and being able to see the changes with a simple refresh was a very exciting way to make progress. Nevertheless, this is the result, the page you are looking at and interacting with. It is my first experience with web design and, I have to say, I am quite pleased with the results. You can find the code for this website on <a href="https://github.com/iSalty/iSalty.github.io" target="_blank">my GitHub page</a> if you are interested. Hopefully this blog proves to be as much fun to read as it is for me to create and update.  
				</p>
			</div>
		</div>
		<!-- End of About this site Post -->

		<hr/>
		
		<!-- LED Bike Wheel Post # 1 -->
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">August 21, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">LED Bike Wheel: 1</h3>
				<p class="post-text">
					The 'LED Bike Wheel' was the title of my senior design project from Arizona State University. It was completed over the last year of school with two of my good buddies from college, Matthew Jackson and Cameron Mahai. It was the last project that I worked on in college and would love to highlight it here because it was such a fun and interesting project. 
				</p>
				<p class="post-text">
					Living in Tempe (one of the most bikeable cities in the US) we encountered many bikes in our daily lives. It was how all three of us (Matt, Cameron, and myself) commuted to campus and back everyday of the week. Bikes, being so central to our daily lives, were at the forefront of our thoughts when it came time to pick a project topic in the Fall of 2015. We had all seen people attempt to put lights on their bikes, but most were just sad strands of LEDs that just went about, producing nothing but a wiggly circle. We wanted take that idea and kick it up a notch. 
				</p>
				<p class="post-text">
					Thus the idea was born that there could be static images displayed on the bike wheel as the bike was in motion using the physical phenomenon of Persistence of Vision. Persistence of Vision is the explanation of how the human eye to retains a discrete image of light for fractions of a second after it has gone. “Whenever light strikes the retina, the brain retains the impression of that light for about a tenth of a second…after the source of the light is removed. As a result, the eye cannot clearly distinguish fast changes in light that occur faster than this retention period.” <a href="http://www.foundationsmag.com/persistence_of_vision.html" target="_blank">[1]</a>. This phenomenon has inspired the creation of many technologies. It is at the core of how motion is perceived by us in movies or on television screens <a href="http://www.foundationsmag.com/persistence_of_vision.html" target="_blank">[1]</a>. The LED Bike Wheel would be able to utilize the sluggishness of the human eye and mind to not only create animation (using multiple frames in succession) but also to create the screen itself. In the assembly there would exists only a few pixels, but when spinning around at a fast enough rate each pixel is perceived by the mind as a solid circle. The color of any point on those circles can be controlled to produce the desired image. An illustration of POV as it relates to our bike display is shown below. 
				</p>
				<div>
					<img class="post-image" src="Pictures/paint of square to polar.png" height="400px" width="auto"/>
				</div>
				<p class="post-text">
					Each blue circle represents what our minds would see from a lit single pixel, rotating about the center faster than our brains could compensate. It is clear to see where in the rotation each LED would need to turn red in order to create the image of the red square, and it is the goal of this project to design a system to do so.
				</p>
			</div>
		</div>
		<!-- End of LED Bike Wheel Post # 1 -->

		<hr/>
		
		<!-- LED Bike Wheel Post # 2 -->
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">August 22, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">LED Bike Wheel: 2</h3>
				<p class="post-text">
					Unsurprisingly, we were not the first people to think of this. However, the other similar projects which have been completed are fairly recent and our project has its own advantages. Here are a couple of products / projects similar to ours worth checking out.
				</p>
				<ul class="post-bullets">
					<li><a href="http://www.monkeylectric.com/monkey_light_pro/" target="_blank">MonkeyLectric's Monkey Light Pro</a></li>
					<li><a href="http://revolights.com/" target="_blank">Revolights</a></li>
				</ul>
				<p class="post-text">
					The MonkeyLectric one is really quite impressive with the quality of the images they are able to recreate. Nevertheless, they have encountered some problems which we have improved upon. MonkeyLectric's product uses Bluetooth to transfer the images from a phone (only iOs at the moment) and does the image processing on the phone as well. After looking through the MonkeyLectric forums we identified that the Bluetooth transfer rate was slow and the processing on phone would drain people's battery and even cause some heat problems. Therefore we elected to have our device work over WiFi (capable of recieving transfers from any internet connected device) and to do the necessary image processing on the bike wheel assembly. Knowing that we needed a pretty powerful system we elected to go with a Raspberry Pi 2: Model B+. It has an ARM compatible CPU which has a clock rate of 900MHz which we could then easily overclock to 1000MHz and is trivial to connect to WiFi (using a $5 WiFi dongle).
				</p>
			</div>
		</div>
		<!-- End of LED Bike Wheel Post # 2 -->

		<hr/>
		
		<!-- LED Bike Wheel Post # 3 -->
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">August 23, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">LED Bike Wheel: 3</h3>
				<p class="post-text">
					Now that we had decided what the product was supposed to be and do, it was time to get to work on actually prototyping it. First up was learning how to work with the Raspberry Pi. It was the first time any of us had worked with microcontrollers like this, fortunatley, the RPi is what is termed a microcomputer. Basically it is a fully functional computer, just miniaturized, complete with a GUI for the desktop and file system. We utilized the Raspbian Jessie operating system which is built on Linux. Therefore, eventhough it has a fully function GUI, it was still beneficial to learn how to work within the command line because of how useful it is on Linux platforms. 
				</p>
				<p class="post-text">
					After fimiliarizing myself with the command line I decided that I wanted to write my first program on the RPi and have it light up some LEDs. The Raspberry Pi has great built in functionality with Python programs and therefore Python was the language of choice when writing most of my programs. Again, I had some learning to do because I had never written a program in Python before. I did, however, have a good working knowledge of C++ so it came to me quick. Using these <a href="https://www.adafruit.com/products/302?gclid=Cj0KEQjw6O-9BRDjhYXH2bOb8Z4BEiQAWRdukxl-JQYDdKpD95jpF_yId-9EI2LiMlpYy1B5FyyQqVoaAvEP8P8HAQ" target="_blank">common anode RGB LEDs</a> I purchased from Adafruit and some resistors I had lying around I was able to quickly whip up <a href="https://github.com/iSalty/LED-Bike-Wheel/blob/master/drive-download-20160823T233046Z/colorFunc.py" target="_blank">this program</a>. The program changes the colors of two LEDs simply by controlling specific GPIO pins to be on or off. A video of the program running can be seen below.
				</p>
				<div class="post-video">
					<iframe width="420" height="315" src="https://www.youtube.com/embed/B8FuRu6dYN0" frameborder="0" allowfullscreen></iframe>
				</div>
			</div>
		</div>
		<!-- End of LED Bike Wheel Post # 3 -->

		<hr/>

		<!-- LED Bike Wheel Post # 4 -->
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">August 24, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">LED Bike Wheel: 4</h3>
				<p class="post-text">
					I had shown that the LEDs could be controlled simply through the Raspberry Pi's GPIO pins. However, we wanted a lot of LEDs on our bike wheel (48 to be exact) and there simply were not enough GPIO pins on the RPi to accomodate that number of LEDs. After some research we elected to go with adding GPIO expander chips from Microchip (the MCP23S17) which would add 16 GPIO ports per chip. In theory the RPi could accomodate adding up to 16 MCP23S17s, we ended up using 12. 
				</p>
				<p class="post-text">
					The reason we needed so many extra ports was because each individual RGB LED required 4 GPIO pins to be controlled. The four pins would control the Red, Green, and Blue pins, as well as Power to the LED. Below, you can see a pin diagram the RGB LEDs and the scheme used to hook them up to the MCP2317s to be controlled.   
				</p>
				<div>
					<img class="post-image" src="Pictures/rgbLED_MCP.PNG"/>
				</div>
				<p class="post-text">
					Because the LEDs used in this assembly are common anode, 5v is put into the common anode and the current flows through wherever there is a voltage differential. Consequently, it runs backwards, in a sense. For example, if Red was the desired color of the LED, the pins would have to be controlled in the following way, [B:1, G:1, R:0, Pow:1]. This way there is only a voltage difference between the voltage input (anode) and the desired return path, red; thus, the LED turns red. 
				</p>
				<p class="post-text">
					The MCP23S17 also added the functionality of being able to write to it a whole byte at a time. This allows us to control one side (2 LEDs)of the MCP23S17 with a single write command. Thus defining the colors as hexadecimal values would make the process of doing this much easier. A table of the colors and their equivalent Hex values is shown below. This will come in handy later when we examine the code that conducts the LEDs during runtime. 
				</p>
				<p class="col-sm-offset-1 col-md-offset-3" style="font-size: 1.4rem">
						K = Black, W = White, R = Red, G = Green, B = Blue, Y = Yellow, P = Purple, C = Cyan
				</p>
				<div class="col-sm-12 col-lg-offset-2 col-lg-9">
					<img class="post-image" src="Pictures/4.2.2.2.PNG" width="100%"/>
				</div>
			</div>
		</div>
		<!-- End of LED Bike Wheel Post # 4 -->

		<hr/>
		
		<!-- LED Bike Wheel Post # 5 -->
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">August 25, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">LED Bike Wheel: 5</h3>
				<p class="post-text">
					It took some time to figure out how to properly talk to the MCP23S17 chips in the code but one specific library was my saving grace, <a href="http://wiringpi.com/" target="_blank">wiringPi</a> by drogon. This specific library has a lot of built in functionality for interfacing with some chips commonly used with the RPi. It provided a simple way to conduct the MCP23S17 chips over the SPI interface.
				</p>
				<p class="post-text">
					Anyway, once I was able to figure out how to work with 4 LEDs connected to one of the MCP23S17 chips it became apparent how we were going to be able to scale up to deal with 48 LEDs. Initially we wanted to design the device to be on Printed Circuit Boards. However, when looking into the monetary cost and, even more importantly, the time cost to have them made and shipped to us we realized that going down this route would leave us with little wiggle room if something were to go wrong. Therefore, we elected to design the product on <a href="https://www.adafruit.com/product/591" target="_blank">solderable breadboards</a>, specialized for prototyping. The solderable breadboards would give us the most flexibility if we made a mistake and were also significantly cheaper than doing the layout on a printed circuit board. The solderable breadboard layout I came up with can be seen below.  
				</p>
				<div>
					<img class="post-image" src="Pictures/SolderableBreadboardLayout.PNG" height="400px"/>
				</div>
				<p class="post-text">
					As you can see in the diagram above, there would be four boards making up the LED Bike Wheel assembly. Each board contains 12 LEDs and the chips needed to control them as well as the appropriate resistors (all 1k&#937). At the top of each board is a Hall effect sensor which is responsible for keeping track of the rate of rotation of the wheel and will be talked about more in a later post.
				</p>
			</div>
		</div>
		<!-- End of LED Bike Wheel Post # 5 -->

		<hr/>
		
		<!-- LED Bike Wheel Post # 6 -->
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">August 26, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">LED Bike Wheel: 6</h3>
				<p class="post-text">
					So we got to work assembling the boards seen in the above diagrams. Because we elected to create our assembly on solderable breadboards we had a considerable amount of soldering ahead of us. None of us had extensive experience soldering before, but by the end of it we were all experts. Each board took around 2-3 hours of soldering to complete and plenty of errors had to be corrected. Our first complete board can be seen in the images below (top = front) (bottom = back). 
				</p>
				<div class="post-image">
					<img src="Pictures/StickAssembly_Front.png" width="100%"/>
				</div>
				<div class="post-image">
					<img src="Pictures/StickAssembly_Back.png" width="100%"/>
				</div>
				<p class="post-text">
					You can see what a mess the wires were on the back of the board, thus the back of the LED Bike Wheel assembly came to be known as the "rat's nest". However, we didn't want the loose wires to get caught on the bike as it was in motion so we took care to neatly zip-tie them to each other as well as to the spokes of the bike wheel (this can be seen in a later post with the full assembly on the bike). 
				</p>
				<p class="post-text">
					Now that the actual hardware portion of the build was complete it was time to focus on the software. The software would handle how to coordinate all 48 LEDs in order to generate a standing image on the bike wheel. But first things first, we just wanted to see if our hack job of a hardware prototype could light up. I had written <a href="https://github.com/iSalty/LED-Bike-Wheel/blob/master/drive-download-20160823T233046Z/rainbow.py" target="_blank">some code here</a> in which I could specify the colors of 12 LEDs and it was finally time to test it out. Unsurprisingly, on the first try, nothing happened. After checking the wiring with a digital multimeter, swapping out a few resistors, and resoldering some wires we were able to get it working. Below you can see an image of all 12 LEDs lighting up in a rainbow fashion.
				</p>
				<div class="post-image">
					<img src="Pictures/boardAssembleLit.jpg" width="100%"/>
				</div>
			</div>
		</div>
		<!-- End of LED Bike Wheel Post # 6 -->

		<hr/>
		
		<!-- LED Bike Wheel Post # 7 -->
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">August 26, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">LED Bike Wheel: 7</h3>
				<p class="post-text">
					In software there are two programs which are central to the design; polarRead and LEDcontrol. Both programs are written in python and operate on the Raspberry Pi which is located on the bike wheel. PolarRead does the image processing before the image can be displayed, and LEDcontrol outputs the proper image to the LEDs on the Bike Wheel. We will look at polarRead.py in more detail here.
				</p>
				<p class="post-text">
					<a href="https://github.com/iSalty/LED-Bike-Wheel/blob/master/drive-download-20160823T233046Z/polarRead.py" target="_blank">PolarRead.py</a> is the program responsible for reading in any image, determining what colors the LEDs should be at each point of the display and saving the data to be used in the other program, LEDcontrol. An image editing library, OpenCV, was utilized in this program because it contains functions already written which are relevant and usable in our design. This image library allows the software to do the appropriate image processing on any type of image (.jpg, .gif, .png, etc). First, the image is read in, then it is resized to 360px by 360px so that a constant resolution is achieved for the bike wheel display. This resolution contains data for 360 degrees of rotation which is necessary to have an image detailed enough to display well on the bike wheel. 
				</p>
				<p class="post-text">
					Next the image has to be converted from Cartesian (x, y) coordinates to polar coordinates (r, θ). Polar coordinates contain data on the radius(r) and angle(θ) of each pixel and, therefore, provide a simpler way to track where the LED boards are and what color they should be as they rotate with the wheel. The function to go from Cartesian coordinates to polar has already been written in the openCV library and is used in this program to do the transformation. However, it is still necessary to understand how this function works in order to properly extract the desired data from its output. A demonstration of its operation is shown in the figure below. Cartesian image (left) to Polar image (right).
				</p>
				<div class="col-sm-12">
					<img class="post-image" src="Pictures/polarRead_prntScrn1.jpg"/>
				</div>
				<p class="post-text">
					The black line shown in the Cartesian image indicates the line where the transformation begins. It takes this line of colors and prints it at the top of the polar image assigning it θ = 0&deg. The transformation then proceeds, swinging the black line around clockwise and printing down on the polar image, every degree rotation clockwise on the cartesian image corresponds to one new row on the polar image. The left side of the polar image represents colors closer to the center of the cartesian image, and the right side of the polar image represents colors furthest away from the center.
				</p>
				<p class="post-text">
					Once the image is in polar format it is easy to extract the relavent color data. Because there are 12 LEDs on each LED board we need to find what color each LED is at each degree of the image, thus we need 12 colors for each degree of the 360 degrees of rotation. This program looks at 12 equidistant pixels for each degree, determines their colors and saves it as a color character (a letter representing the color). These color characters are then saved into a text file which is later utilized in the LEDcontrol program. A selection of the color characters saved for the above image can be seen below (again left = centermost). 
				</p>
				<div>
					<img class="post-image" src="Pictures/polarRead_prntScrn2.jpg"/>
				</div>
			</div>
		</div>
		<!-- End of LED Bike Wheel Post # 7 -->

		<hr/>
		
		<!-- LED Bike Wheel Post # 8 -->
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">August 29, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">LED Bike Wheel: 8</h3>
				<p class="post-text">
					Finally, we can take a look at the second program <a href="https://github.com/iSalty/LED-Bike-Wheel/blob/master/drive-download-20160823T233046Z/LEDcontrol.py" target="_blank">LEDcontrol.py</a> which is the program that actually runs while the bike wheel is in motion. It is responsible for keeping track of the speed of the bike as well as updating the LEDs with the correct colors every single degree of rotation (can be as fast as once every millisecond). Here I will delve a bit into how the program functions to accomplish this. 
				</p>
				<p class="post-text">
					Initially, the text file (created from the polarRead program) is read in which contains the list of 4320 color characters (12x360), multiple text files can be read; each representing a single frame of an image. Using multiple frames in quick succession allows the LED Bike Wheel to display animations. Now that the color characters are available, they need to be translated into something the computer can understand to properly output to the LEDs, therefore they are translated into bytes using the scheme seen back in post: LED Bike Wheel 4. I have shown the table below again to demonstrate how the color characters are represented in hex.
				</p>
				<div>
					<img class="post-image" src="Pictures/4.2.2.2.PNG">
				</div>
				<p class="post-text">
					A byte is 8 bits, a hexidecimal number is 4 bits, therefore two hex numbers make up a byte. This means that a byte carries with it the data for the colors of two LEDs (1 hex value per LED). The wiringPi library allows us to write to the MCP23S17 using a buffer containing two bytes of information. Because of this we want to combine our hex values into bytes which we then represent in decimal. This process proved to be more complicated than it initially seemed due to the way in which we wired up the LEDs to the MCP23S17 chips. Below I have shown a set of data which had been taken from the color characters, to hex, and finally to decimal. The whole process of going from color characters to decimal values happens within the first 140 lines of <a href="https://github.com/iSalty/LED-Bike-Wheel/blob/master/drive-download-20160823T233046Z/LEDcontrol.py" target="_blank">LEDcontrol.py</a>. The write commands that actually send the data out (wiringPiSPIDataRW(_)) to the LEDs can be seen around lines 911-922 of the code.
				</p>
				<div>
					<img class="post-image" src="Pictures/realDeal_prntScrn.jpg">
				</div>
				<p class="post-text">
					You will notice how things in the hex list seem out of place, this is due to the 'complexity' mentioned above with the way that the LEDs were wired to the MCP23S17 chips. This was done to keep track of which LEDs are located in the positions that the Most Significant Bits control. Therefore the hex list looks to the second color character then to the first, then to the fourth, then to the third, and so on.  
				</p>
			</div>
		</div>
		<!-- End of LED Bike Wheel Post # 8 -->

		<hr/>
		<!-- LED Bike Wheel Post # 9 -->
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">September 14, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">LED Bike Wheel: 9</h3>
				<p class="post-text">
					At this point we have all of the necessary information regarding the colors of the display saved into the Decimal List seen in the previous post's image. Each decimal represents two Hexadecimal values and each hex value represents a single LED's color (in other words each decimal number in the above list represents 2 LED colors). Now we needed a method to grab the right colors from the decimal list given any particular location of the LED boards. To do this I created a function called Degree (located at line 726 in <a href="https://github.com/iSalty/LED-Bike-Wheel/blob/master/drive-download-20160823T233046Z/LEDcontrol.py" target="_blank">LEDcontrol.py</a>) which would take the angle of LED board 1 as an input and output the relevant color data for all four boards.
				</p>
				<p class="post-text">
					How it knows which values to pick from the long list of decimal values is demonstrated in an example below. Say we want the colors relevant to Frame 1 at Θ = 175&deg. (Θ is the position of LED board 1) Knowing that each stick is 90&deg apart, the other stick angles can be found.
				</p>
				<div>
					<img class="post-image" src="Pictures/degreeEquations.PNG">
				</div>
				<p class="post-text">
					Here is a visual representation of how the degrees are represented on the bike wheel. I choose this system because it is the same way that the cartesian to polar transformation occured (seen back in LED Bike post #7).
				</p>
				<div>
					<img class="post-image" src="Pictures/RearWheelCoordinates.jpg">
				</div>
				<p class="post-text">
					All of the color data is stored in the list colorsDecimal which contains 2160 decimal values per frame. Each degree corresponds to 6 decimals of that list because each decimal represents the colors of 2 LEDs (12 colors need to be represented at each degree because there are 12 LEDs on one LED board). For this example we want to find those 6 decimal values for the degrees 175, 265, 355, and 85. Frame 1 is the first frame of the list. The following equation is used to get the starting and ending points that we require from the colorsDecimal list/array.
				</p>
				<div>
					<img class="post-image" src="Pictures/degreeEquations2.PNG">
				</div>
				<p class="post-text">
					Above we see the starting and stopping points needed to get the colors for LED boards 1 and 2, the same method is emplyed to get the colors for boards 3 and 4. The degree function will return the 24 decimal values selected using the above equations which can then be sent out to the MCP23S17 chips to turn the LEDs the proper colors. After completing this section of code we were able to run a test of our prototyped board to see if this software piece was retrieving the correct colors and displaying properly. It turns out on the first try it worked! Below you can see a video of LED stick 1 lighting up the proper colors to display the image on the screen. Imagine the stick rotating in a counter-clockwise direction in order to create the image (goes blue then purple, red, yellow, green, cyan and so on). In this video I just used a static RPM value for testing.
				</p>
				<div class="post-video">
					<iframe width="560" height="315" src="https://www.youtube.com/embed/ybZIKRL-arc" frameborder="0" allowfullscreen></iframe>
				</div>	
			</div>
		</div>
		<!-- End of LED Bike Wheel Post # 9 -->

		<hr/>

		<!-- LED Bike Wheel Post # 10 -->
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">September 15, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">LED Bike Wheel: 10</h3>
				<p class="post-text">
					Now all we have left to do is figure out how to keep track of where the LED boards are in their rotation about the wheel and how fast they are moving (RPM) and feed that information to the Degree function talked about before. Hall effect sensors and timing play a pivotal role in this section of the design. The hall effect sensor (shown in the diagram below to the right) outputs a signal whenever it is in the presence of a magnetic field. That magnetic field will be coming from a magnet attached to the frame of the bike, external to the moving wheel (The magnet is notified by that blue circle on the left-most image below).
				</p>
				<div>
					<img class="post-image" src="Pictures/rearWheelHall.PNG">
				</div>
				<p class="post-text">
					The hall sensor is fed with 5V and is pulled up with a 1kOhm resistor. Therefore, it outputs 5V when there is no magnetic field and drops down to 0V when there is a magnetic field present. Vout feeds back to the Raspberry Pi where it is constantly reading the input of the hall sensor. As soon as the hall sensor passes the magnet on the bike frame it drops to 0V and the Raspberry Pi knows it just passed the magnet i.e., where it is in its rotation. 
				</p>
				<p class = "post-text">
					Using this information to ascertain the RPM of the wheel is fairly simple. Take a time reading when it passes the magnet, take another time reading when the next one passes the magnet. Take the difference between the two times and you have the time it took for the wheel to rotate 90 degrees (because each LED board is 90 degrees apart). Multiply that number by 4 to get how many seconds it takes to do 1 full rotation (this is Seconds Per Rotation). Invert seconds per rotation to get rotations per second, then multiply by 60 to get rotations per minute (RPM). The library which allows the RPi to get readings of the time in seconds is aptly named, <a href="https://docs.python.org/2/library/time.html" target="_blank">Time</a> and is used throughout the program for this purpose. However, using the method stated above for calculating RPM, readings only occur every 90 degrees of rotation. Therefore the RPi on really knows for sure where the LED boards are at these exact moments of reading, it has to guess where they are inbetween readings using the calculated RPM value.
				</p>
				<p class="post-text">
					These guesses attempt to figure out when the wheel has rotated one degree by <u>assuming that the RPM stays constant between readings</u>. How we do this is using the calculated RPM value we are able to find the time it would take to rotate 1 degree (using rotations per second divided by 360 degrees). It then waits that amount of time before sending out the next LED write commands, thus, updating the display every degree of rotation. While it may get slightly off between readings it is corrected every quarter of a rotation when the next reading occurs. This effect is barely perceptable to veiwers because it happens so quickly that the assumption of the RPM not changing between readings is close enough to reality. 
				</p>
			</div>
		</div>
		<!-- End of LED Bike Wheel Post # 10 -->

		<hr/>


		<!-- LED Bike Wheel Post # 11 -->
		<div class="row">
			<div class="col-sm-2">
				<img class="user-img" src="http://images.clipartpanda.com/hercules-clip-art-hercules001.gif"/>
				<h5 class="author">iSaltwick</h5> 
				<h5 class="post-date">September 16, 2016</h5>
			</div>
			<div class="col-md-8 col-sm-10">
				<h3 class="post-title">LED Bike Wheel: 11</h3>
				<p class="post-text">
					We have finally completed the design. The RPM tracking and the color retrieving functions worked just as expected. After some final testing and more resoldering to fix some loose wires it was time to put the entire assembly on the bike wheel. I will show you again what the setup is so that we can see the design and the actual prototype side by side.
				</p>
				<div>
					<img class="post-image" src="Pictures/SolderableBreadboardLayout.PNG" height="400px"/>
				</div>
				<div style="text-align: center;">
					<img src="Pictures/Prototype_Back.jpg" height="394px" style="margin-bottom: 15px;"/>
					<img src="Pictures/Prototype_Front_lit.PNG" height="394px" style="margin-bottom: 15px;"/>
				</div>
				<p class="post-text">
					The battery we used was a simple power bank, meant to be used for charging phones and the like. It had a capacity of 4400mAh which would give us over 6 hours of operation on a single charge and worked perfectly for powering the whole assembly. It was finally time to give the wheel a spin and see if it did indeed create the desired image as a standing image on the bike wheel. First, I show how a single LED board would look as it goes about the rotation and second a video of the whole assembly coming together to produce the image.
				</p>
				<div class="post-video">
					<iframe width="300" height="400" src="https://www.youtube.com/embed/_-Dj4on961s" frameborder="0" allowfullscreen></iframe>
					<iframe width="300" height="400" src="https://www.youtube.com/embed/3JCiKtywYF4" frameborder="0" allowfullscreen></iframe>
				</div>
				<p class="post-text">
					Keep in mind that it looks better in real life because it is hard for cameras to capture the Persistence of Vision effect. In fact we found that the worse the camera was, the better it was able to capture the image. After playing around with a few images we realized that the image quality was not quite as good as we thought it might be so we had to display very simple images. This was due to the fact that there were only 12 LEDs on each board, effectivley limiting the resolution of the image. However the display was still bright and visually pleasing and we were thrilled with the results.
				</p>
				<p class="post-text">
					After our demonstration I continued to ride the LED Bike around Tempe for two months before retiring it. I received a lot of looks and comments (which was exactly the point) and had a great time telling people how my group had made it. It was a fantastic project to be involved in from beginning to end and I personally think it was one of the coolest senior design projects of our class (but who wouldn't think their own project was the best). I will end the LED Bike Wheel project posts with my favorite picture of myself (in the purple) and my teammates at demo-day showing off our stellar project.
				</p>
				<div>
					<img class="post-image" src="Pictures/demo_day.jpg"
				</div>
			</div>
		</div>
		<!-- End of LED Bike Wheel Post # 11 -->

	</section>
	<footer class="container">
  		<div class="row">
      		<p class="col-sm-4" style="color:#cccccc">
        	&copy; 2016 iSalty
      		</p>
      		<ul class="col-sm-8">
        		<a href="https://www.linkedin.com/in/ian-saltwick-23591b81"  target="_blank"><li class="col-sm-1"> <img src="logos/linkedin_footer_logo.png"></li></a>
        		<a href="https://www.facebook.com/ian.saltwick" target="_blank"><li class="col-sm-1"> <img src="logos/facebook_footer_logo.gif"></li></a>
        		<a href="https://github.com/iSalty" target="_blank"><li class="col-sm-1"> <img src="http://www.iconsdb.com/icons/preview/gray/github-10-xxl.png"></li></a>
      		</ul>
    	</div>
  	</footer>
</body>
</html>